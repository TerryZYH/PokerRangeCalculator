# 概率计算说明

## 📊 手牌组合数计算

### 基本概念

在德州扑克中，每种手牌**表示**（如 AA、AKs、AKo）实际上包含**多个具体组合**。正确计算概率需要考虑每种表示的实际组合数。

### 组合数详解

#### 1. 对子 (Pairs)

**例子**: AA, KK, QQ, ..., 22

**计算**: 从4种花色中选2张相同点数的牌
```
C(4,2) = 4! / (2! × 2!) = 6 种组合
```

**AA 的 6 种组合**:
- ♠A ♥A
- ♠A ♦A
- ♠A ♣A
- ♥A ♦A
- ♥A ♣A
- ♦A ♣A

**总计**: 13 个对子 × 6 = **78 种组合**

---

#### 2. 同色牌 (Suited)

**例子**: AKs, AQs, KQs, ..., 32s

**计算**: 两张不同点数的牌，花色相同
```
4 种花色 × 1 = 4 种组合
```

**AKs 的 4 种组合**:
- ♠A ♠K
- ♥A ♥K
- ♦A ♦K
- ♣A ♣K

**总计**: 78 个同色类型 × 4 = **312 种组合**

---

#### 3. 不同色牌 (Offsuit)

**例子**: AKo, AQo, KQo, ..., 32o

**计算**: 两张不同点数的牌，花色不同
```
4 × 3 = 12 种组合
```

**AKo 的 12 种组合**:
- ♠A ♥K
- ♠A ♦K
- ♠A ♣K
- ♥A ♠K
- ♥A ♦K
- ♥A ♣K
- ♦A ♠K
- ♦A ♥K
- ♦A ♣K
- ♣A ♠K
- ♣A ♥K
- ♣A ♦K

**总计**: 78 个不同色类型 × 12 = **936 种组合**

---

## 🎯 总组合数验证

```
对子组合数:    13 × 6  = 78
同色组合数:    78 × 4  = 312
不同色组合数:  78 × 12 = 936
─────────────────────────────
总计:                    1326 种组合 ✓
```

这就是为什么德州扑克有 **1326** 种起手牌组合！

---

## 📐 概率计算公式

### 正确的计算方法

```typescript
// 1. 计算选中手牌的总组合数
totalCombinations = Σ(每种手牌的组合数)

// 2. 计算概率
probability = (totalCombinations / 1326) × 100%
```

### 示例计算

#### 示例 1: 只选择 AA

```
AA 的组合数 = 6
概率 = 6 / 1326 × 100% = 0.45%
```

每 221 手牌中，大约会拿到 1 次 AA

---

#### 示例 2: 选择 AA + KK

```
AA 的组合数 = 6
KK 的组合数 = 6
总组合数 = 12

概率 = 12 / 1326 × 100% = 0.90%
```

每 110 手牌中，大约会拿到 1 次 AA 或 KK

---

#### 示例 3: 选择 AKs + AKo

```
AKs 的组合数 = 4
AKo 的组合数 = 12
总组合数 = 16

概率 = 16 / 1326 × 100% = 1.21%
```

每 83 手牌中，大约会拿到 1 次 AK

---

#### 示例 4: 选择所有对子 (AA-22)

```
对子组合数 = 13 × 6 = 78

概率 = 78 / 1326 × 100% = 5.88%
```

每 17 手牌中，大约会拿到 1 次对子

---

## 🔍 常见范围的组合数

### UTG Open (约 15%)

**包含**: AA-QQ, AKs, AKo, AQs, AQo, AJs, KQs

```
组合数计算:
- AA, KK, QQ: 3 × 6 = 18
- AKs: 4
- AKo: 12
- AQs: 4
- AQo: 12
- AJs: 4
- KQs: 4
────────────────────
总计: 58 组合

概率 = 58 / 1326 × 100% ≈ 4.37%
```

> 注：实际 UTG Open 范围通常更宽（15-20%），这里仅为示例

---

### BTN Open (约 40-50%)

包含大量手牌类型，组合数约 530-663 种
```
概率 = 530-663 / 1326 × 100% ≈ 40-50%
```

---

## 💡 实际应用

### 在应用中的展示

```
┌──────────────────────────────────────┐
│  已选手牌类型: 10 种类型              │
│  实际组合数:   68 种组合 / 1326      │
│  出现概率:     5.13%                 │
│                                       │
│  计算公式: 68 ÷ 1326 × 100% ≈ 5.13% │
│  说明: 对子6种·同色4种·不同色12种    │
└──────────────────────────────────────┘
```

### 三个关键数字

1. **手牌类型数** (如 10): 你在矩阵中选中的格子数
2. **实际组合数** (如 68): 这些类型对应的具体发牌组合
3. **出现概率** (如 5.13%): 拿到这些牌的实际概率

---

## 🎓 为什么这很重要？

### 错误的计算方法 ❌

```
选中 10 种手牌类型
错误概率 = 10 / 169 × 100% = 5.92%
```

这是**错误的**！因为：
- 不同类型的组合数不同
- AA 只有 6 种组合
- AKo 有 12 种组合
- 直接用类型数除以 169 会得到错误结果

### 正确的计算方法 ✓

```
选中 10 种手牌类型
实际组合数 = 68（根据具体选择计算）
正确概率 = 68 / 1326 × 100% = 5.13%
```

---

## 📊 完整的计算代码

```typescript
// 获取每种手牌的组合数
function getHandCombinations(handName: string): number {
  if (handName.length === 2) {
    // 对子（如 AA, KK）
    return 6;
  } else if (handName.endsWith('s')) {
    // 同色（如 AKs）
    return 4;
  } else if (handName.endsWith('o')) {
    // 不同色（如 AKo）
    return 12;
  }
  return 0;
}

// 计算总组合数
function calculateTotalCombinations(selectedHands: Set<string>): number {
  let total = 0;
  selectedHands.forEach(handName => {
    total += getHandCombinations(handName);
  });
  return total;
}

// 计算概率
function calculateProbability(selectedHands: Set<string>): number {
  const totalCombinations = calculateTotalCombinations(selectedHands);
  return (totalCombinations / 1326) * 100;
}
```

---

## 🔢 快速参考表

| 手牌类型 | 组合数 | 示例 |
|---------|--------|------|
| 对子 | 6 | AA, KK, 22 |
| 同色 | 4 | AKs, KQs, 76s |
| 不同色 | 12 | AKo, KQo, 76o |

| 范围描述 | 类型数 | 组合数 | 概率 |
|---------|--------|--------|------|
| 所有对子 | 13 | 78 | 5.88% |
| 所有同色 | 78 | 312 | 23.53% |
| 所有不同色 | 78 | 936 | 70.59% |
| 所有手牌 | 169 | 1326 | 100% |

---

## ✅ 应用中的改进

### 更新内容

1. **概率显示组件** 
   - 显示"手牌类型数" 
   - 显示"实际组合数"
   - 显示正确的"出现概率"

2. **范围列表**
   - 显示类型数
   - 显示组合数
   - 显示准确概率

3. **计算公式提示**
   - 解释组合数概念
   - 显示完整计算过程

### 使用示例

选择以下手牌：
- **AA** (6 组合)
- **KK** (6 组合)
- **AKs** (4 组合)
- **AKo** (12 组合)

```
总组合数 = 6 + 6 + 4 + 12 = 28
概率 = 28 / 1326 × 100% = 2.11%
```

这意味着**每 47 手牌中约有 1 次**拿到这些牌！

---

**现在应用计算的是真实的德州扑克概率！** 🎯

